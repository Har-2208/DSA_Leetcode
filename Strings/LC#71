#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char* simplifyPath(char* path) {
    int len = strlen(path);
    char** stack = (char**)malloc(len * sizeof(char*));
    int top = -1;

    char* token = strtok(path, "/");

    while (token != NULL) {
        if (strcmp(token, "..") == 0) {
            if (top >= 0) top--;  // go back
        }
        else if (strcmp(token, ".") == 0 || strcmp(token, "") == 0) {
            // ignore
        }
        else {
            stack[++top] = token;  // push folder
        }
        token = strtok(NULL, "/");
    }

    // Allocate result string
    char* result = (char*)malloc(len + 1);
    result[0] = '\0';

    if (top == -1) {
        strcpy(result, "/");
    } else {
        for (int i = 0; i <= top; i++) {
            strcat(result, "/");
            strcat(result, stack[i]);
        }
    }

    free(stack);
    return result;
}
